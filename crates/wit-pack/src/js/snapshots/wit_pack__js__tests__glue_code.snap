---
source: crates/wit-pack/src/js/mod.rs
assertion_line: 256
expression: contents
---

import fs from "fs/promises";
import path from "path";
import * as url from "url";


export default async function() {
    const wrapper = new WitPack();

    const scriptDir = url.fileURLToPath(new URL('.', import.meta.url));
    const wasm = await fs.readFile(path.join(scriptDir, "wit-pack-wasm.wasm"));


    let moduleToAwait;
    if (WebAssembly.compileStreaming) {
      moduleToAwait = WebAssembly.compileStreaming(wasm);
    }
    else {
      moduleToAwait = WebAssembly.compile(wasm);
    }


    const module = await moduleToAwait;
    const imports = {};


    await wrapper.instantiate(module, imports);


    return wrapper;
}


